$package("js.awt");$import("js.awt.BaseComponent");$import("js.awt.Editable");$import("js.awt.Movable");$import("js.awt.PopupLayer");$import("js.awt.Resizable");$import("js.awt.State");$import("js.awt.Shadow");$import("js.util.Observer");js.awt.Component = function (def, Runtime, view) {var ccount = 0;var CLASS = js.awt.Component, thi$ = CLASS.prototype;if (CLASS.__defined__) {this._init.apply(this, arguments);return;}CLASS.__defined__ = true;var Class = js.lang.Class, Event = js.util.Event, DOM = J$VM.DOM, System = J$VM.System, MQ = J$VM.MQ;thi$.setPosition = function (x, y, fire) {var M = this.def, U = this._local;arguments.callee.__super__.apply(this, arguments);fire = !Class.isNumber(fire) ? 0 : fire;if ((fire & 4) != 0) {U.userX = M.x;U.userY = M.y;}if ((fire & 1) != 0) {this.onMoved(fire);}}.$override(this.setPosition);thi$.setZ = function (z, fire) {var M = this.def, U = this._local;arguments.callee.__super__.apply(this, arguments);fire = !Class.isNumber(fire) ? 0 : fire;if ((fire & 4) != 0) {U.userZ = M.z;}if ((fire & 1) != 0) {this.onZOrderChanged(fire);}}.$override(this.setZ);thi$.setSize = function (w, h, fire) {var M = this.def, U = this._local;arguments.callee.__super__.apply(this, arguments);fire = !Class.isNumber(fire) ? 0 : fire;if ((fire & 4) != 0) {U.userW = M.width;U.userH = M.height;}if ((fire & 1) != 0) {this.onResized(fire);}}.$override(this.setSize);thi$.setBounds = function (x, y, w, h, fire) {var M = this.def, U = this._local;arguments.callee.__super__.apply(this, arguments);fire = Class.isNumber(fire) ? fire : 0;if ((fire & 4) != 0) {U.userX = M.x;U.userY = M.y;U.userW = M.width;U.userH = M.height;}if ((fire & 1) != 0) {this.onGeomChanged(fire);}}.$override(this.setBounds);thi$._adjust = function (cmd, show) {switch (cmd) {case "move":case "resize":var bounds = this.getBounds();this.adjustCover(bounds);this.adjustResizer(bounds);this.adjustShadow(bounds);break;case "zorder":var z = this.getZ();this.setCoverZIndex(z);this.setResizerZIndex(z);this.setShadowZIndex(z);break;case "display":this.setCoverDisplay(show);this.setResizerDisplay(show);this.setShadowDisplay(show);break;case "remove":this.removeCover();this.removeResizer();this.removeShadow();break;}}.$override(this._adjust);thi$.hasScrollbar = function () {return DOM.hasScrollbar(this.view);};thi$.applyStyles = function (styles) {if (arguments.callee.__super__.apply(this, arguments)) {this.onGeomChanged(2);}}.$override(this.applyStyles);thi$.setController = function (ctrl) {this.controller = ctrl;this.controller.setContainer(this);};thi$.delController = function () {var ctrl = this.controller;if (ctrl) {ctrl.removeFrom(this.view);delete ctrl.container;delete this.controller;}return ctrl;};thi$.isAlwaysOnTop = function () {return this.def.alwaysOnTop || false;};thi$.setAlwaysOnTop = function (b) {b = b || false;var ZM = this.container;if (ZM) {ZM.setCompAlwaysOnTop(this, b);}};thi$.bringForward = function () {var ZM = this.container;if (ZM) {ZM.bringCompForward(this);}};thi$.bringToFront = function () {var ZM = this.container;if (ZM) {ZM.bringCompToFront(this);}};thi$.sendBackward = function () {var ZM = this.container;if (ZM) {ZM.sendCompBackward(this);}};thi$.sendToBack = function () {var ZM = this.container;if (ZM) {ZM.sendCompToBack(this);}};thi$.setPeerComponent = function (peer) {this.peer = peer;};thi$.getPeerComponent = function () {return this.peer;};thi$.notifyPeer = function (msgId, event, sync) {var peer = this.getPeerComponent();if (peer) {_notify.call(this, peer, msgId, event, sync);}};thi$.setContainer = function (container) {this.container = container;if (container && this.isMovable() && container instanceof js.awt.Container && container.isAutoFit()) {var moveObj = this.getMoveObject(), msgType = moveObj.getMovingMsgType();MQ.register(msgType, this, _onMovingEvent);moveObj.releaseMoveObject();delete this.moveObj;}};thi$.getContainer = function () {return this.container;};thi$.notifyContainer = function (msgId, event, sync) {var comp = this.getContainer();if (comp) {_notify.call(this, comp, msgId, event, sync);}};var _notify = function (comp, msgId, event, sync) {sync = (sync == undefined) ? this.def.sync : sync;if (sync == true) {MQ.send(msgId, event, [comp.uuid()]);} else {MQ.post(msgId, event, [comp.uuid()]);}};thi$.setSynchronizedNotify = function (b) {this.def.sync = b || false;};thi$.isSynchronizedNotify = function () {return this.def.sync || false;};var _onMovingEvent = function (e) {var container = this.getContainer();if (container && (container instanceof js.awt.Container) && container.isAutoFit()) {container.autoResize();}};thi$.activateComponent = function () {var container = this.container;if (container) {container.activateComponent(this);}};thi$.openDialog = function (className, rect, dialogObj, handler) {var dialogs = this.getDialogs(), dialog = J$VM.Factory.createComponent(className, rect, this.Runtime());dialogs.push(dialog);dialog.setPeerComponent(this);dialog.setDialogObject(dialogObj, handler);dialog.show();return dialog;};thi$.getDialogs = function () {this._local.dialogs = this._local.dialogs || js.util.LinkedList.$decorate([]);return this._local.dialogs;};thi$.openConfirm = function (className, rect, def, handler) {def = def || {};def.className = def.className || "msgbox";def.stateless = true;def.model = def.model || {};def.model.msgType = "confirm";return this.openDialog(className, rect, new js.awt.MessageBox(def, this.Runtime()), handler);};thi$.repaint = function () {if (arguments.callee.__super__.apply(this, arguments)) {var M = this.def;if (M.movable === true && !this.movableSettled()) {this.setMovable(true);}if (M.resizable === true && !this.resizableSettled()) {this.setResizable(true, M.resizer);}if (M.shadow === true && !this.shadowSettled()) {this.setShadowy(true);}if (M.isfloating === true && !this.floatingSettled()) {this.setFloating(true);}if (this.resizableSettled()) {this.addResizer();this.adjustResizer();}if (this.shadowSettled()) {this.addShadow();this.adjustShadow();}this.showDisableCover(!this.isEnabled());return true;}return false;}.$override(this.repaint);thi$.doLayout = function (force) {if (arguments.callee.__super__.apply(this, arguments)) {var ctrl = this.controller;if (ctrl) {ctrl.appendTo(this.view);var bounds = this.getBounds(), cbounds = ctrl.getBounds(), x, y, w, h;w = ctrl.isRigidWidth() ? cbounds.width : bounds.innerWidth;h = ctrl.isRigidHeight() ? cbounds.height : bounds.innerHeight;x = bounds.MBP.paddingLeft + (bounds.innerWidth - w) * ctrl.getAlignmentX();y = bounds.MBP.paddingTop + (bounds.innerHeight - h) * ctrl.getAlignmentY();ctrl.setBounds(x, y, w, h, 7);}return true;}return false;}.$override(this.doLayout);thi$.onMoved = function (fire) {};thi$.onResized = function (fire) {if ((fire & 2) != 0) {this.doLayout(true);}};thi$.onZOrderChanged = function (fire) {};thi$.onGeomChanged = function (fire) {if ((fire & 2) != 0) {this.doLayout(true);}};thi$.onStateChanged = function (e) {if (!this.isStateless()) {var buf = this.__buf__.clear();buf.append(this.def.className).append("_").append(this.getState());this.view.className = buf.toString();}if (this.view.parentNode) {this.showDisableCover(!this.isEnabled());}};thi$.destroy = function () {this.setShadowy(false);this.setResizable(false);this.setMovable(false);if (this.controller) {this.controller.destroy();delete this.controller;}var dialogs = this.getDialogs(), dialog;while (dialogs.length > 0) {dialog = dialogs.shift();if (dialog._local) {dialog.destroy();}}var container = this.container;if (container && container instanceof js.awt.Container) {container.removeComponent(this);}delete this.container;delete this.peer;arguments.callee.__super__.apply(this, arguments);}.$override(this.destroy);thi$._init = function (def, Runtime, view) {if (def == undefined) {return;}def.classType = def.classType || "js.awt.Component";arguments.callee.__super__.apply(this, arguments);view = this.view;var buf = this.__buf__ = new js.lang.StringBuffer();if (!this.isStateless()) {def.state = def.state || 0;view.className = buf.append(def.className).append("_").append(this.getState()).toString();}view.id = def.classType + "." + ccount++;if (def.prefSize) {this.isPreferredSizeSet = true;}if (def.miniSize) {this.isMinimumSizeSet = true;}if (def.maxiSize) {this.isMaximumSizeSet = true;}var tip = def.tip;if (Class.isString(tip) && tip.length > 0) {this.setToolTipText(tip);}}.$override(this._init);this._init.apply(this, arguments);}.$extend(js.awt.BaseComponent).$implements(js.awt.State, js.util.Observer, js.awt.Shadow, js.awt.Movable, js.awt.MoveObject, js.awt.Resizable, js.awt.SizeObject, js.awt.Editable, js.awt.PopupLayer);