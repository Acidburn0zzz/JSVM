$package("js.util");js.util.Base64 = new function () {var base64chars = "ABCDEFGHIJKLMNOP" + "QRSTUVWXYZabcdef" + "ghijklmnopqrstuv" + "wxyz0123456789@*" + "-";var utf8_ucs2 = function (s) {if (!s) {return null;}var len = s.length;if (len == 0) {return "";}var d = [], c = 0, i = 0, tmp = 0;while (i < len) {c = s[i++];if ((c & 224) == 224) {tmp = (c & 15) << 12;c = s[i++];tmp |= ((c & 63) << 6);c = s[i++];tmp |= (c & 63);} else {if ((c & 192) == 192) {tmp = (c & 31) << 6;c = s[i++];tmp |= (c & 63);} else {tmp = c;}}d.push(String.fromCharCode(tmp));}return d.join("");};var ucs2_utf8 = function (s) {if (!s) {return null;}var d = [];if (s == "") {return d;}var c = 0, i = 0, j = 0, len = s.length;while (i < len) {c = s.charCodeAt(i++);if (c <= 127) {d[j++] = c;} else {if ((c >= 128) && (c <= 2047)) {d[j++] = ((c >> 6) & 31) | 192;d[j++] = (c & 63) | 128;} else {d[j++] = (c >> 12) | 224;d[j++] = ((c >> 6) & 63) | 128;d[j++] = (c & 63) | 128;}}}return d;};this.encode = function (s) {if (!s || s.length == 0) {return s;}var d = [], b = ucs2_utf8.call(this, s), len = b.length, b0, b1, b2, b3, i = 0, tmp;while (i < len) {tmp = b[i++];b0 = (tmp & 252) >> 2;b1 = (tmp & 3) << 4;if (i < len) {tmp = b[i++];b1 |= (tmp & 240) >> 4;b2 = (tmp & 15) << 2;if (i < len) {tmp = b[i++];b2 |= (tmp & 192) >> 6;b3 = tmp & 63;} else {b3 = 64;}} else {b2 = b3 = 64;}d.push(base64chars.charAt(b0));d.push(base64chars.charAt(b1));d.push(base64chars.charAt(b2));d.push(base64chars.charAt(b3));}return d.join("");};this.decode = function (s) {if (!s) {return null;}var len = s.length;if (len % 4 != 0) {throw new Error(s + " is not a valid Base64 string.");}var b = [], i = 0, j = 0, e = 0, c, tmp;while (i < len) {c = base64chars.indexOf(s.charAt(i++));tmp = c << 18;c = base64chars.indexOf(s.charAt(i++));tmp |= c << 12;c = base64chars.indexOf(s.charAt(i++));if (c < 64) {tmp |= c << 6;c = base64chars.indexOf(s.charAt(i++));if (c < 64) {tmp |= c;} else {e = 1;}} else {e = 2;i++;}b[j + 2] = tmp & 255;tmp >>= 8;b[j + 1] = tmp & 255;tmp >>= 8;b[j + 0] = tmp & 255;j += 3;}b.splice(b.length - e, e);return utf8_ucs2.call(this, b);};}();